(this["webpackJsonpsocial-app"]=this["webpackJsonpsocial-app"]||[]).push([[0],{152:function(e,t,n){},153:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(4),c=n.n(o),i=n(3),u=n(35),l=n(9),s=n(29),m=n.n(s),h={token:null,isAuthenticated:null,user:null},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_USER":return Object(l.a)(Object(l.a)({},e),{},{token:t.token,isAuthenticated:!0,user:t.user});case"LOGIN_SUCCESS":case"REGISTER_SUCCESS":return m.a.set("token",t.token),Object(l.a)(Object(l.a)(Object(l.a)({},e),t.token),{},{token:t.token,isAuthenticated:!0,user:t.user});case"LOGIN_FAIL":case"REGISTER_FAIL":case"LOGOUT_SUCCESS":return m.a.remove("token"),Object(l.a)(Object(l.a)({},e),{},{token:null,user:null,isAuthenticated:!1});default:return e}},d={posts:[]},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_POST":return Object(l.a)(Object(l.a)({},e),{},{posts:e.posts.concat(t.posts)});case"NEW_POST":return Object(l.a)(Object(l.a)({},e),{},{posts:e.posts.concat(t.newPost)});case"EDIT_POST":return Object(l.a)(Object(l.a)({},e),{},{posts:e.posts.map((function(e){return e.id===t.editedPost.id?t.editedPost:e}))});case"DELETE_POST":return Object(l.a)(Object(l.a)({},e),{},{posts:e.posts.filter((function(e){return e.id!==t.toDeletePost.id}))});default:return e}},E=Object(u.b)({auth:p,posts:f}),b=Object(u.c)(E,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),g=(n(97),n(66)),y=n(6),O=n(15),k=n(155),j=n(13),v=n(156),S=n(157),w=function(e){return{type:"EDIT_POST",editedPost:e}},T=n(75),x=n.n(T),C=function(){var e=Object(i.c)((function(e){return e.auth.isAuthenticated})),t=Object(i.c)((function(e){return e.auth.user})),n=Object(i.c)((function(e){return e.auth.token})),o=Object(i.c)((function(e){return e.posts.posts})),c=Object(a.useState)(""),u=Object(j.a)(c,2),l=u[0],s=u[1],m=Object(a.useState)(""),h=Object(j.a)(m,2),p=h[0],d=h[1],f=Object(a.useState)(""),E=Object(j.a)(f,2),b=E[0],g=E[1],y=Object(i.b)();Object(a.useEffect)((function(){0===o.length&&fetch("https://api-minireseausocial.mathis-dyk.fr/posts").then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})).then((function(e){y(function(e){return{type:"LOAD_POST",posts:e}}(e))}))}),[o,y]);var T=S.a.Title,C=k.a.Header,N=k.a.Content;return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{className:"site-layout-sub-header-background",style:{padding:0,textAlign:"center"}},r.a.createElement(T,null,"Welcome on My Social Network.")),r.a.createElement(N,{style:{margin:"24px 16px 0"}},r.a.createElement("div",{className:"site-layout-background",style:{padding:24,minHeight:360}},e&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Hello ",t.username,", what do you want to share with us today ?"),r.a.createElement("div",{className:"form-box"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a={text:l,user:t.id};fetch("https://api-minireseausocial.mathis-dyk.fr/posts",{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(a)}).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})).then((function(e){y({type:"NEW_POST",newPost:e}),s("")})).catch((function(e){alert(e)}))},className:"msg-box"},r.a.createElement("textarea",{type:"text",placeholder:"Your shitty message...",onChange:function(e){return s(e.target.value)},value:l}),r.a.createElement("input",{type:"submit",className:"btn-submit"}))),r.a.createElement(v.a,null,"News feed")),r.a.createElement("div",null,r.a.createElement("ul",null,o.sort((function(e,t){return new Date(t.created_at)-new Date(e.created_at)})).map((function(a){return!(!a.text||!a.user)&&r.a.createElement("li",{key:a.id},e&&a.user.id===t.id&&b!==a.id&&r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:x.a,alt:"delete post",onClick:function(){return e=a,void(window.confirm("Le message va \xeatre supprim\xe9")&&fetch("https://api-minireseausocial.mathis-dyk.fr/posts/".concat(e.id),{method:"delete",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}}).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})).then((function(e){y({type:"DELETE_POST",toDeletePost:e})})).catch((function(e){alert(e)})));var e},style:{height:"1em"}}),r.a.createElement("button",{onClick:function(){return g(a.id)}},"Edit")),e&&r.a.createElement(O.b,{to:"/user/".concat(a.user.id)},r.a.createElement("b",null,a.user.username," : ")),b!==a.id&&r.a.createElement(r.a.Fragment,null,a.text),e&&b!==a.id&&r.a.createElement("span",{onClick:function(){return function(e){var t={like:e.like+1};fetch("https://api-minireseausocial.mathis-dyk.fr/posts/".concat(e.id),{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(t)}).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})).then((function(e){y(w(e)),g("")})).catch((function(e){alert(e)}))}(a)}}," ",r.a.createElement("b",null,"|")," ","\u2764 ".concat(a.like?a.like:0)," ",r.a.createElement("b",null,"|")),b===a.id&&r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{value:p,onFocus:function(){return d(a.text)},autoFocus:!0,onChange:function(e){return d(e.target.value)}}),r.a.createElement("button",{onClick:function(){return function(e){var t={text:p};fetch("https://api-minireseausocial.mathis-dyk.fr/posts/".concat(e.id),{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(t)}).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})).then((function(e){y(w(e)),g("")})).catch((function(e){alert(e)}))}(a)}},"edit post"),r.a.createElement("button",{onClick:function(){return g("")}},"cancel")))})))))))},N=function(){var e=Object(i.c)((function(e){return e.auth.isAuthenticated})),t=Object(a.useState)(""),n=Object(j.a)(t,2),o=n[0],c=n[1],u=Object(a.useState)(""),l=Object(j.a)(u,2),s=l[0],m=l[1],h=Object(i.b)(),p=Object(y.g)();Object(a.useEffect)((function(){e&&p.push("/")}),[e,p]);var d=k.a.Header,f=k.a.Content,E=S.a.Title;return r.a.createElement(r.a.Fragment,null,r.a.createElement(d,{className:"site-layout-sub-header-background",style:{padding:0,textAlign:"center"}},r.a.createElement(E,null,"Login")),r.a.createElement(f,{style:{margin:"24px 16px 0"}},r.a.createElement("div",{className:"site-layout-background",style:{padding:24,minHeight:360,height:"100%"}},r.a.createElement("div",{className:"form-box"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t={identifier:o,password:s};fetch("https://api-minireseausocial.mathis-dyk.fr/auth/local/",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})).then((function(e){h(function(e){return{type:"LOGIN_SUCCESS",token:e.jwt,user:e.user}}(e)),p.push("/")})).catch((function(e){h({type:"LOGIN_FAIL"}),alert("Mauvais email ou mot de passe")}))}},r.a.createElement("input",{type:"text",placeholder:"Your Email",value:o,onChange:function(e){return c(e.target.value)},required:!0}),r.a.createElement("input",{type:"password",placeholder:"Your unforgettable password",value:s,onChange:function(e){return m(e.target.value)},required:!0}),r.a.createElement("input",{type:"submit",className:"btn-submit"}))))))},_=n(158),A=n(159),I=n(161),L=n(160),D=function(){var e=Object(i.c)((function(e){return e.auth.isAuthenticated})),t=Object(i.b)(),n=Object(y.g)(),a=function(){t({type:"LOGOUT_SUCCESS"}),n.push("/")},o=k.a.Sider;return e?r.a.createElement(r.a.Fragment,null,r.a.createElement(o,{breakpoint:"lg",collapsedWidth:"0",onBreakpoint:function(e){console.log(e)},onCollapse:function(e,t){console.log(e,t)}},r.a.createElement("div",{className:"logo"}),r.a.createElement(_.a,{theme:"dark",mode:"inline",defaultSelectedKeys:["1"]},r.a.createElement(_.a.Item,{key:"1",icon:r.a.createElement(A.a,null)},r.a.createElement(O.b,{to:"/"}," Home ")),r.a.createElement(_.a.Item,{key:"4",icon:r.a.createElement(A.a,null)},r.a.createElement(O.b,{to:"/profile"}," Profile ")),r.a.createElement(_.a.Item,{key:"5"},r.a.createElement("p",{onClick:a},"Se d\xe9connecter"))))):r.a.createElement(r.a.Fragment,null,r.a.createElement(o,{breakpoint:"lg",collapsedWidth:"0",onBreakpoint:function(e){console.log(e)},onCollapse:function(e,t){console.log(e,t)}},r.a.createElement("div",{className:"logo"}),r.a.createElement(_.a,{theme:"dark",mode:"inline",defaultSelectedKeys:["1"]},r.a.createElement(_.a.Item,{key:"1",icon:r.a.createElement(A.a,null)},r.a.createElement(O.b,{to:"/"}," Home ")),r.a.createElement(_.a.Item,{key:"2",icon:r.a.createElement(I.a,null)},r.a.createElement(O.b,{to:"/login"}," Login ")),r.a.createElement(_.a.Item,{key:"3",icon:r.a.createElement(L.a,null)},r.a.createElement(O.b,{to:"/register"}," Register ")))))},F=function(){var e=Object(a.useState)(""),t=Object(j.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(""),u=Object(j.a)(c,2),l=u[0],s=u[1],m=Object(a.useState)(""),h=Object(j.a)(m,2),p=h[0],d=h[1],f=Object(i.b)(),E=Object(y.g)(),b=k.a.Header,g=k.a.Content,O=S.a.Title;return r.a.createElement(r.a.Fragment,null,r.a.createElement(b,{className:"site-layout-sub-header-background",style:{padding:0,textAlign:"center"}},r.a.createElement(O,null,"Register")),r.a.createElement(g,{style:{margin:"24px 16px 0"}},r.a.createElement("div",{className:"site-layout-background",style:{padding:24,minHeight:360,height:"100%"}},r.a.createElement("div",{className:"form-box"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t={username:n,email:l,password:p};fetch("https://api-minireseausocial.mathis-dyk.fr/auth/local/register",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})).then((function(e){f(function(e){return{type:"REGISTER_SUCCESS",token:e.jwt,user:e.user}}(e)),E.push("/")})).catch((function(e){f({type:"REGISTER_FAIL"}),alert(e)}))}},r.a.createElement("input",{type:"text",placeholder:"Your fancy username",value:n,onChange:function(e){return o(e.target.value)},required:!0}),r.a.createElement("input",{type:"text",placeholder:"Your email (for spamming you a lot of course)",value:l,onChange:function(e){return s(e.target.value)},required:!0}),r.a.createElement("input",{type:"password",placeholder:"Password (as weak as possible, our security is shitty as fuck anyway)",value:p,onChange:function(e){return d(e.target.value)},required:!0}),r.a.createElement("input",{type:"submit",className:"btn-submit"}))))))},P=S.a.Title,H=function(){var e=Object(i.c)((function(e){return e.auth.user})),t=Object(i.c)((function(e){return e.auth.token})),n=Object(i.c)((function(e){return e.posts.posts})),a=e.id,o=e.username,c=k.a.Header,u=k.a.Content;return r.a.createElement(r.a.Fragment,null,r.a.createElement(c,{className:"site-layout-sub-header-background",style:{padding:0,textAlign:"center"}},r.a.createElement(P,null,"Welcome on your profile.")),r.a.createElement(u,{style:{margin:"24px 16px 0"}},r.a.createElement("div",{className:"site-layout-background",style:{padding:24,minHeight:360,height:"100%"}},r.a.createElement("p",null,"id : ",a),r.a.createElement("p",null,"name : ",o),r.a.createElement("button",{onClick:function(){n.forEach((function(e){if(!e.like){var n={like:Math.floor(Math.random()*Math.floor(1e3))};fetch("https://api-minireseausocial.mathis-dyk.fr/posts/".concat(e.id),{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(n)}).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})).then((function(e){console.log(e)})).catch((function(e){alert(e)}))}}))}},"like for all"))))},R=function(){var e=Object(i.c)((function(e){return e.auth.token})),t=Object(a.useState)({}),n=Object(j.a)(t,2),o=n[0],c=n[1],u=Object(a.useState)([]),l=Object(j.a)(u,2),s=l[0],m=l[1],h=Object(y.h)().userId;Object(a.useEffect)((function(){fetch("https://api-minireseausocial.mathis-dyk.fr/users/".concat(h),{method:"get",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})).then((function(e){c(e)})).catch((function(e){alert(e)})),fetch("https://api-minireseausocial.mathis-dyk.fr/posts?user.id=".concat(h),{method:"get",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})).then((function(e){m(e)})).catch((function(e){alert(e)}))}),[e,h]);var p=k.a.Header,d=k.a.Content,f=S.a.Title;return r.a.createElement(r.a.Fragment,null,r.a.createElement(p,{className:"site-layout-sub-header-background",style:{padding:0,textAlign:"center"}},r.a.createElement(f,null,"Welcome on ",o.username,"'s profile.")),r.a.createElement(d,{style:{margin:"24px 16px 0"}},r.a.createElement("div",{className:"site-layout-background",style:{padding:24,minHeight:360,height:"100%"}},r.a.createElement("div",null,r.a.createElement("p",null,"id : ",o.id),r.a.createElement("p",null,"name : ",o.username),r.a.createElement("p",null,"description : ",o.description)),r.a.createElement("h2",null,"Les messages post\xe9s par ",o.username),r.a.createElement("ul",null,s.sort((function(e,t){return new Date(t.created_at)-new Date(e.created_at)})).map((function(e){return!(!e.text||!e.user)&&r.a.createElement("li",{key:e.id},r.a.createElement("b",null,e.user.username," : "),e.text,r.a.createElement("span",{onClick:function(){return console.log("like")}}," ",r.a.createElement("b",null,"|")," ","\u2764 ".concat(e.like?e.like:0)," ",r.a.createElement("b",null,"|")))}))))))},B=(n(152),function(){var e=Object(i.c)((function(e){return e.auth.isAuthenticated})),t=Object(i.b)();Object(a.useEffect)((function(){m.a.get("token")&&fetch("https://api-minireseausocial.mathis-dyk.fr/users/me",{method:"get",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m.a.get("token"))}}).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})).then((function(e){t(function(e){return{type:"LOAD_USER",user:e,token:m.a.get("token")}}(e))})).catch((function(e){console.log(e)}))}),[t]);var n=function(t){var n=t.component,a=Object(g.a)(t,["component"]);return r.a.createElement(y.b,Object.assign({},a,{render:function(t){return e?r.a.createElement(y.a,{to:{pathname:"/"}}):r.a.createElement(n,t)}}))},o=function(t){var n=t.component,a=Object(g.a)(t,["component"]);return r.a.createElement(y.b,Object.assign({},a,{render:function(t){return e?r.a.createElement(n,t):r.a.createElement(y.a,{to:{pathname:"/login"}})}}))},c=(k.a.Header,k.a.Content,k.a.Footer);k.a.Sider;return r.a.createElement(k.a,{style:{minHeight:"100vh"}},r.a.createElement(O.a,{basename:"/NextSocialApp"},r.a.createElement(D,null),r.a.createElement(k.a,null,r.a.createElement(y.d,null,r.a.createElement(n,{path:"/login",component:N}),r.a.createElement(n,{path:"/register",component:F}),r.a.createElement(o,{path:"/profile",component:H}),r.a.createElement(o,{path:"/user/:userId",component:R}),r.a.createElement(y.b,{exact:!0,path:"/",component:C})),r.a.createElement(c,{style:{textAlign:"center"}},"Luca Montaigut - 2020 | Made with \u2764"))))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(i.a,{store:b},r.a.createElement(B,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},75:function(e,t,n){e.exports=n.p+"static/media/trash.0eb3b1bc.svg"},88:function(e,t,n){e.exports=n(153)}},[[88,1,2]]]);
//# sourceMappingURL=main.8af27392.chunk.js.map